## 📆 2021-12-31(금) TIL

### 📈 오늘 한 일
- [x] Conners 인증에 관한 문제 리서치 및 어떻게 할지 결정
- [x] 2021년 연말 회고 작성
  - https://haranglog.tistory.com/29

### 🦄 이번주 목표 진행사항은요? (오늘 조금이라도 진행했으면 체크)
- [ ] 스칼라로 배우는 함수형 프로그래밍 7장 읽고 스터디
- ~~리팩터링 9장 읽고 스터디~~
- [x] Conners 프로젝트 구현
- [x] 2021 연말 회고 작성하기

### 🤔 공부하면서 배운것이 있다면?

#### Conners 로그인 관련한 부분에 대한 문제점 파악 및 해결 방안

지금 next auth를 사용해서 로그인 구현했었다.    
그리고 firestore에 유저 세션, 정보를 저장중이다.    

문제가 되는점.    

firestore의 보안규칙이 있는데 이 보안규칙을 적용하려면 firebase가 제공하는 next-auth가 아닌 firebase auth를 사용해야한다.   

- 해결방법. 
제일 명확한 해결 방안: next auth가 아닌 firebase auth로 변경하기. 하지만 공수가 크다.. 그리고 next auth가 해줬던 사용자 인증과 관련된 부분들을 모두 구현해야한다. (access-token.. 세션 유지 등등..) 그리고 카카오 로그인은 firebase auth에서 제공하지 않아서 커스텀 인증 설정을 통해 구현해야한다.(커스텀 OAuth를 사용한 경우 세션 유지는 무조건 최대 1시간)    
장점. 명확하다… firebase v.9로 마이그레이션 가능.

- 다른 해결방안. 
next-auth를 사용해 firebase에 저장을 하고 있는데 유저정보와 세션정보들을 저장하지 않는다. 저장하지 않고 JWT만 사용하여 firebase auth와 커스텀으로 연동시킨다. 그리고 firebase auth를 통해 보안 규칙을 설정할 수 있다.   
문제가 되는점은 가능한지 모르겠다. 그리고 next-auth와 firebase-auth 두 개의 디펜던시가 강하게 걸려있어서 사용자 인증 및 세션을 어떻게 유지가 되는지 명확하지 않다. next-auth와 firebase-auth 둘다 세션관리를 해줘야한다. 예를 들어, next-auth에서 로그아웃을 해주고, firebase-auth에서도 로그아웃을 해줘야한다.
장점. 공수가 덜 든다.   

### ⚡ 아쉬운 점 및 회고
2021년 마지막날이다. 오늘은 연간회고도 작성했고 2021년 마지막 TIL을 작성하고 있다. 내년에는 TIL을 계속 작성할지는 모르겠다. 어쨌든, 하고 싶은게 정말 많은 2021년도에 이어 2022년도도 할게 정말 많아보인다. 앞으로 계속 성장에 있어서도 고민해볼거 같다.   

하지만 2022년은 조금은 여유를 가지고 건강을 챙기자. 몸이 썩어가는 느낌..? 오래 못살거 같은 그런 느낌..?   

2021년도 그래도 만족스럽다. 2021년보다 더 나은 2022년이 되었으면 좋겠다.   

오늘 Conners를 만드는데 있어서 로그인 세션과 관련해서 진짜 하루종일 고민했다. 이제 어떻게 해야할지는 정했다. 공수가 진짜 많이 들거 같지만, 방법이 없다. 주말동안 붙잡고 있으면 되겠지..?ㅠㅠ

### 🚀 내일 할 일
- Conners 프로젝트 구현
- 1월 1일!

### 🎯 이번주 목표
- 반가워 2022!