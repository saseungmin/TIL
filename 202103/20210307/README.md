## 📆 2021-03-07(일) TIL

### 📈 어제의 계획이 예상대로 진행됐나요?
- [ ] 알고리즘 공부
- [ ] 오브젝트 4장 읽기
- [x] Recoil를 사용한 ToDo 앱 만들기 진행하기
  - [cors에러 해결](https://github.com/saseungmin/Recoil_Todo_Backend/pull/20)
  - [쿠키 토큰을 사용해 로그인시 유저 정보 확인](https://github.com/saseungmin/Recoil_ToDo/pull/50)

### 🦄 이번주 목표 진행사항은요? (오늘 조금이라도 진행했으면 체크)
- [ ] 알고리즘 공부
- [x] Recoil를 사용한 ToDo 앱 만들기 진행하기
- [ ] 긍적적 사고방식과 할 수 있는 것과 할 수 없는 것을 구분 잘하기
- [ ] 시간 분배 잘하기와 쓸대 없이 시간낭비하는 시간 아끼기

### 🤔 공부하면서 배운것이 있다면?

#### 🎈 Recoil를 사용한 ToDo 앱 만들기 진행하기
- `cors` 설정에 있어서 애를 먹었다.
- 다 설정을 해주었다고 생각했지만, 토큰은 쿠키에 저장해 유저의 session정보를 관리하였다. 여기서 `cookie`를 사용할 때, local에서는 되었지만, 배포 후 `cors`애러가 발생하였다.
- 그래서 인터넷에서 찾아본 결과, 여러가지를 찾아보았는데 백앤드 부분도 배포가 되어있고, 프론트앤드도 배보가 되어있는 상태의 다른 도메인 간에 쿠키를 전송하기 위해서는 백앤드, 프론트앤드에서 설정을 추가해줘야 한다.

- 일단 다음과 같이 `axios`를 사용할 때, `withCredentials`옵션을 `true`로 설정을 해주어야 한다.
```js
const client = axios.create({
  baseURL: BASE_URL,
  withCredentials: true,
});
```

- 여기서 `Access-Control-Allow-Origin` 값이 `*`일 때는 지원하지 않기 때문에, 백앤드에서 `origin`에 서버의 호스트 정보를 입력해주거나, 상황에 맞게 변경해주어야 한다.
- `koa/cors`에서는 `origin`의 `default` 값이 `request Origin header`이기 때문에 별다른 설정을 해줄 필요가 없다. `credentials`도 `true` 변경해준다.


```js
import cors from '@koa/cors';

app.use(cors({
  credentials: true,
}));
```

- 그리고 heroku에서 `cookie`를 사용할 때 `Access-Control-Allow-Origin`를 해결하려면 한가지 설정을 해줘야한다.
- `cookie`에 옵션을 추가해주어야 한다.
- `secure`옵션은 웹 브라우저와 웹 서버가 `HTTPS`로 통신하는 경우에만 웹 브라우저가 쿠키를 서버로 전송하는 옵션이다.
- `httpOnly`옵션은 자바스크립트의 `document.cookie`를 이용해 쿠키에 접속하는 것을 막는 옵션이다.
- `SameSite` 는 웹 응용 프로그램에서 CSRF (교차 사이트 요청 위조) 공격을 방지 하기 위해 HTTP 쿠키에 설정할 수 있는 속성이다. 2020년 2월? 부터 Chrome 기본값이 `Lax` 모드로 변경되어서 `none`으로 변경해주었다. 이때 `Lax`는 모든 요청에 ​​대해 쿠키가 전송되기 때문에, Heroku에서는 이 상태를 막아두었다. 때문에 변경해줘야 했다. 
- `none` 속성은 쿠키의 모든 컨텍스트, 즉 i.e 및 cross origin 요청에 대한 응답으로 전송된다. `none` 속성에 대해서는 `secure`를 `true`로 변경해주어야만 전송이 가능하다.
- `Strict` 이면 쿠키는 동일한 사이트 내 에서만 요청에서 전송된다.

```js
ctx.cookies.set('access_token', token, {
  maxAge: 1000 * 60 * 60 * 24 * 5,
  httpOnly: true,
  sameSite: 'none', 
  secure: true,
});
```
### ⚡ 아쉬운 점 및 회고
- 아쉬운 점은 오늘 계획을 못 지켰다. 공부에 소홀해질려고 한다. 뭘 하고자 하는지 모르겠다. 하고 싶은 것만 찾는다.
- 현재 해야할 것을 구분하여 계획을 지키자.
- 금, 토요일에 공부를 열심히 안했다. 공부를 했어도 분명 내가 하고 싶은 것만 했을 것이다.
- 뭔가 딜레마에 빠진거 같다. 공부는 재밌다. 충분히 너무 재밌다. 번아웃 그딴건 절대 아니다. 하지만, 직장이 없어서 그런가 계속 뭔가 잘 안된다는 생각만 가득하다. 벌써 퇴사한지도 1달하고 1주일이 지났고, 3월달이 되었다. 봄이 왔고, 올해가 된지 벌써 3달이 넘었다. 나이는 27살이고 하는 건 없다. 후우우우우우우우우
- 긍정적이게 좀 생각하자.... 긍정적이게 생각하기 보다 급하게 좀 생각하지 말자. 
- 급하게 생각하니 급하게 공부하게 되고 또 다른 사람들과 비교하게 되어서 내 페이스를 잃고 계속 못쉬면서 공부를 하게 되는거 같다. 
- 쉴때는 마음 좀 편히 가지고 쉬었으면 좋겠다. 그리고 공부와 휴식을 균형을 가지고 이어나가야 되는데 쉽지 않다.. ㅠㅠ


### 🚀 내일 할 일
- 알고리즘 공부
- 오브젝트 4장 읽기

### 🎯 이번주 목표
- 알고리즘 공부
- 오브젝트 책 Chapter 6 까지 읽기 및 스터디 참여
- Recoil를 사용한 ToDo 앱 만들기 진행하기
- 긍적적 사고방식과 할 수 있는 것과 할 수 없는 것을 구분 잘하기
- 시간 분배 잘하기와 쓸대 없이 시간낭비하는 시간 아끼기